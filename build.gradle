


buildscript {
    ext {
        mfVers = "5.0.1"
        kotlin_version = "1.3.11"
    }

    repositories {

        mavenCentral()
        maven { url 'https://gitlab.com/api/v4/projects/9908493/packages/maven' }

    }


    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:" + "$kotlin_version"
    }
}



plugins {
    id 'java-library'
    //warum kann ich hier nicht $kotlin_version einsetzen??
    id "org.jetbrains.kotlin.jvm" version  "1.3.11"
    id 'war'
}



repositories {

    mavenCentral()
    maven { url 'https://gitlab.com/api/v4/projects/9908493/packages/maven' }

}


//apply plugin: 'java'
//apply plugin: 'kotlin'

//repositories {

//    mavenCentral()
//    maven { url 'https://gitlab.com/api/v4/projects/9908493/packages/maven' }

//}


configurations {
    localDeps
    compile.extendsFrom(localDeps)
}


dependencies {

    // Use JUnit test framework
    testImplementation "junit:junit:4.12"
    compile "org.apache.axis2:axis2:1.7.9"
    compile group: 'org.apache.ws.commons.axiom', name: 'axiom-api', version: '1.2.22'
    compile "org.apache.axis2:axis2-kernel:1.7.9"




    localDeps group: 'org.jetbrains.kotlin', name: 'kotlin-stdlib', version: "$kotlin_version"
    localDeps 'org.swissbib.linked:metafacture-kafka:2.0-gh'
    localDeps "org.mongodb:mongo-java-driver:3.10.1"
    localDeps group: 'org.apache.kafka', name: 'kafka-clients', version: '2.1.1'
    localDeps group: 'org.metafacture', name: 'metafacture-io', version: "$mfVers"
    localDeps "org.metafacture:metafacture-framework:${mfVers}"
    localDeps group: 'org.apache.kafka', name: 'kafka_2.12', version: '2.1.1'

//    compile group: 'org.jetbrains.kotlin', name: 'kotlin-stdlib', version: "$kotlin_version"
//    compile 'org.swissbib.linked:metafacture-kafka:2.0-gh'
//    compile "org.mongodb:mongo-java-driver:3.10.1"
//    compile group: 'org.apache.kafka', name: 'kafka-clients', version: '2.1.1'
//    compile group: 'org.metafacture', name: 'metafacture-io', version: "$mfVers"
//    compile "org.metafacture:metafacture-framework:${mfVers}"
//    compile group: 'org.apache.kafka', name: 'kafka_2.12', version: '2.1.1'




}

gradle.projectsEvaluated {
    tasks.withType(JavaCompile) {
        options.compilerArgs += ["-Xlint:unchecked","-Xlint:deprecation"]
    }
}


jar {
    into('lib') {
        from configurations.localDeps
    }
    metaInf { from 'src/main/resources/services.xml' }

    into ("main/resources/org/swissbib/srw") {
        from 'src/main/resources/org/swissbib/srw/createRecordForRDFPipeline.xslt'
    }
    archivesBaseName = 'SRWSearchDocumentsCatcher'

    //manifest {
    //    attributes(
    //            "Class-Path": configurations.localDeps.collect { 'lib/' + it.getName() }.join(' '))
    //}

}


task customJar(type: Exec) {
    dependsOn clean
    dependsOn jar
    workingDir '.'
    commandLine "./scripts/movejar.sh"
}
